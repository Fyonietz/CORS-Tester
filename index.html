<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CORS Tester</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      background: #1e1e1e;
      color: #ddd;
      padding: 2rem;
    }
    h1 {
      color: #61dafb;
    }
    label {
      display: block;
      margin-top: 1rem;
    }
    input, select, textarea, button {
      width: 100%;
      margin-top: 0.5rem;
      padding: 0.5rem;
      border: 1px solid #444;
      border-radius: 4px;
      background: #2c2c2c;
      color: #ddd;
      font-family: monospace;
    }
    button {
      background: #61dafb;
      color: #000;
      cursor: pointer;
      font-weight: bold;
    }
    button:hover {
      background: #4ec3e0;
    }
    pre {
      background: #111;
      padding: 1rem;
      border-radius: 4px;
      overflow-x: auto;
      font-family: monospace;
      white-space: pre-wrap;
      word-wrap: break-word;
    }
    .response-section {
      margin-top: 2rem;
    }

    /* Syntax highlighting for JSON */
    .string { color: #98c379; }
    .number { color: #d19a66; }
    .boolean { color: #56b6c2; }
    .null { color: #c678dd; }
    .key { color: #e06c75; }
  </style>
</head>
<body>
  <h1>CORS Tester</h1>

  <label for="url">Target URL</label>
  <input type="text" id="url" placeholder="https://example.com/api">

  <label for="method">HTTP Method</label>
  <select id="method">
    <option value="GET">GET</option>
    <option value="POST">POST</option>
  </select>

  <label for="body">JSON Body (for POST)</label>
  <textarea id="body" rows="8" placeholder='{"key": "value"}'></textarea>

  <button id="sendBtn">Send Request</button>

  <div class="response-section">
    <h2>Response</h2>
    <h3>Status:</h3>
    <pre id="status"></pre>

    <h3>Headers:</h3>
    <pre id="headers"></pre>

    <h3>Body:</h3>
    <pre id="response"></pre>
  </div>

  <script>
    // Simple JSON syntax highlighter
    function syntaxHighlight(json) {
      if (typeof json != 'string') {
        json = JSON.stringify(json, undefined, 2);
      }
      json = json
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;');
      return json.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g, match => {
        let cls = 'number';
        if (/^"/.test(match)) {
          if (/:$/.test(match)) {
            cls = 'key';
          } else {
            cls = 'string';
          }
        } else if (/true|false/.test(match)) {
          cls = 'boolean';
        } else if (/null/.test(match)) {
          cls = 'null';
        }
        return `<span class="${cls}">${match}</span>`;
      });
    }

    document.getElementById('sendBtn').addEventListener('click', async () => {
      const url = document.getElementById('url').value.trim();
      const method = document.getElementById('method').value;
      const bodyText = document.getElementById('body').value.trim();

      if (!url) {
        alert("Please enter a URL!");
        return;
      }

      const options = {
        method,
        headers: { "Content-Type": "application/json" }
      };

      if (method === "POST" && bodyText) {
        try {
          options.body = JSON.stringify(JSON.parse(bodyText));
        } catch {
          alert("Invalid JSON!");
          return;
        }
      }

      document.getElementById('status').textContent = "Loading...";
      document.getElementById('headers').textContent = "";
      document.getElementById('response').innerHTML = "";

      try {
        const res = await fetch(url, options);
        const resText = await res.text();

        document.getElementById('status').textContent = `${res.status} ${res.statusText}`;

        let headers = "";
        res.headers.forEach((v, k) => headers += `${k}: ${v}\n`);
        document.getElementById('headers').textContent = headers;

        try {
          const json = JSON.parse(resText);
          document.getElementById('response').innerHTML = syntaxHighlight(json);
        } catch {
          document.getElementById('response').textContent = resText;
        }

      } catch (err) {
        document.getElementById('status').textContent = "Request Failed";
        document.getElementById('response').textContent = err.toString();
      }
    });
  </script>
</body>
</html>
